{"ast":null,"code":"import { initializeApp } from \"firebase/app\";\nimport { getDatabase, set, ref, onValue } from \"firebase/database\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAN-PNbJlAmJ_zQ6Juyn1ATWAo4PRGxaCY\",\n  authDomain: \"coman-app-react.firebaseapp.com\",\n  projectId: \"coman-app-react\",\n  storageBucket: \"coman-app-react.appspot.com\",\n  messagingSenderId: \"443294717061\",\n  appId: \"1:443294717061:web:1f6110e2d9c8ab90c5c5ec\",\n  databaseURL: \"https://coman-app-react-default-rtdb.europe-west1.firebasedatabase.app\"\n};\nconst app = initializeApp(firebaseConfig);\n\nclass Database {\n  constructor() {\n    this.database = getDatabase(app);\n  }\n\n  async setItem(path, id, item) {\n    await set(ref(this.database, `${path}/${id}`), item);\n  }\n\n  async readItem(path, id) {\n    return new Promise((resolve, _) => {\n      const reference = ref(this.database, `${path}/${id}`);\n      onValue(reference, item => {\n        return resolve(item.val());\n      });\n    });\n  }\n\n  async searchItems(path, query) {\n    return new Promise((resolve, _) => {\n      const reference = ref(this.database, `${path}/`);\n      onValue(reference, allItemsInPath => {\n        const filteredItems = Object.entries(allItemsInPath).filter(_ref => {\n          let [id, item] = _ref;\n          Object.entries(query).map(_ref2 => {\n            let [key, value] = _ref2;\n            return key in item && item[key] === value;\n          }).reduce((acc, cur) => acc && cur, true);\n        });\n      });\n    });\n  }\n\n}\n\nconst database = new Database();\nexport default database;","map":{"version":3,"sources":["D:/Bureau/Test React/coman-app/src/utils/database.js"],"names":["initializeApp","getDatabase","set","ref","onValue","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","databaseURL","app","Database","constructor","database","setItem","path","id","item","readItem","Promise","resolve","_","reference","val","searchItems","query","allItemsInPath","filteredItems","Object","entries","filter","map","key","value","reduce","acc","cur"],"mappings":"AAAA,SAASA,aAAT,QAA8B,cAA9B;AACA,SAASC,WAAT,EAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,OAAhC,QAA+C,mBAA/C;AAEA,MAAMC,cAAc,GAAG;AACrBC,EAAAA,MAAM,EAAE,yCADa;AAErBC,EAAAA,UAAU,EAAE,iCAFS;AAGrBC,EAAAA,SAAS,EAAE,iBAHU;AAIrBC,EAAAA,aAAa,EAAE,6BAJM;AAKrBC,EAAAA,iBAAiB,EAAE,cALE;AAMrBC,EAAAA,KAAK,EAAE,2CANc;AAOrBC,EAAAA,WAAW,EAAE;AAPQ,CAAvB;AAUA,MAAMC,GAAG,GAAGb,aAAa,CAACK,cAAD,CAAzB;;AAEA,MAAMS,QAAN,CAAe;AACXC,EAAAA,WAAW,GAAG;AACV,SAAKC,QAAL,GAAgBf,WAAW,CAACY,GAAD,CAA3B;AACH;;AAEY,QAAPI,OAAO,CAACC,IAAD,EAAOC,EAAP,EAAWC,IAAX,EAAiB;AAC1B,UAAMlB,GAAG,CAACC,GAAG,CAAC,KAAKa,QAAN,EAAiB,GAAEE,IAAK,IAAGC,EAAG,EAA9B,CAAJ,EAAsCC,IAAtC,CAAT;AACH;;AAEa,QAARC,QAAQ,CAACH,IAAD,EAAOC,EAAP,EAAW;AACrB,WAAO,IAAIG,OAAJ,CAAY,CAACC,OAAD,EAAUC,CAAV,KAAgB;AAC/B,YAAMC,SAAS,GAAGtB,GAAG,CAAC,KAAKa,QAAN,EAAiB,GAAEE,IAAK,IAAGC,EAAG,EAA9B,CAArB;AACAf,MAAAA,OAAO,CAACqB,SAAD,EAAaL,IAAD,IAAU;AACzB,eAAOG,OAAO,CAACH,IAAI,CAACM,GAAL,EAAD,CAAd;AACH,OAFM,CAAP;AAGH,KALM,CAAP;AAMH;;AAEgB,QAAXC,WAAW,CAACT,IAAD,EAAOU,KAAP,EAAc;AAC3B,WAAO,IAAIN,OAAJ,CAAY,CAACC,OAAD,EAAUC,CAAV,KAAgB;AAC/B,YAAMC,SAAS,GAAGtB,GAAG,CAAC,KAAKa,QAAN,EAAiB,GAAEE,IAAK,GAAxB,CAArB;AACAd,MAAAA,OAAO,CAACqB,SAAD,EAAaI,cAAD,IAAoB;AACnC,cAAMC,aAAa,GAAGC,MAAM,CAACC,OAAP,CAAeH,cAAf,EAA+BI,MAA/B,CAClB,QAAkB;AAAA,cAAjB,CAAEd,EAAF,EAAMC,IAAN,CAAiB;AACdW,UAAAA,MAAM,CAACC,OAAP,CAAeJ,KAAf,EAAsBM,GAAtB,CAA2B,SAAoB;AAAA,gBAAnB,CAAEC,GAAF,EAAOC,KAAP,CAAmB;AAC3C,mBAAOD,GAAG,IAAIf,IAAP,IAAeA,IAAI,CAACe,GAAD,CAAJ,KAAcC,KAApC;AACH,WAFD,EAEGC,MAFH,CAEU,CAACC,GAAD,EAAMC,GAAN,KAAcD,GAAG,IAAIC,GAF/B,EAEoC,IAFpC;AAGH,SALiB,CAAtB;AAOH,OARM,CAAP;AASH,KAXM,CAAP;AAYH;;AA/BU;;AAkCf,MAAMvB,QAAQ,GAAG,IAAIF,QAAJ,EAAjB;AAEA,eAAeE,QAAf","sourcesContent":["import { initializeApp } from \"firebase/app\";\r\nimport { getDatabase, set, ref, onValue } from \"firebase/database\"\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyAN-PNbJlAmJ_zQ6Juyn1ATWAo4PRGxaCY\",\r\n  authDomain: \"coman-app-react.firebaseapp.com\",\r\n  projectId: \"coman-app-react\",\r\n  storageBucket: \"coman-app-react.appspot.com\",\r\n  messagingSenderId: \"443294717061\",\r\n  appId: \"1:443294717061:web:1f6110e2d9c8ab90c5c5ec\",\r\n  databaseURL: \"https://coman-app-react-default-rtdb.europe-west1.firebasedatabase.app\"\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\n\r\nclass Database {\r\n    constructor() {\r\n        this.database = getDatabase(app);\r\n    }\r\n\r\n    async setItem(path, id, item) {\r\n        await set(ref(this.database, `${path}/${id}`), item)\r\n    }\r\n\r\n    async readItem(path, id) {\r\n        return new Promise((resolve, _) => {\r\n            const reference = ref(this.database, `${path}/${id}`);\r\n            onValue(reference, (item) => {\r\n                return resolve(item.val());\r\n            })\r\n        })\r\n    }\r\n\r\n    async searchItems(path, query) {\r\n        return new Promise((resolve, _) => {\r\n            const reference = ref(this.database, `${path}/`);\r\n            onValue(reference, (allItemsInPath) => {\r\n                const filteredItems = Object.entries(allItemsInPath).filter(\r\n                    ([ id, item ]) => {\r\n                        Object.entries(query).map( ([ key, value ]) => {\r\n                            return key in item && item[key] === value\r\n                        }).reduce((acc, cur) => acc && cur, true)\r\n                    }\r\n                )\r\n            })\r\n        })\r\n    }\r\n}\r\n\r\nconst database = new Database();\r\n\r\nexport default database;"]},"metadata":{},"sourceType":"module"}