{"ast":null,"code":"import { initializeApp } from \"firebase/app\";\nimport { getDatabase, set, ref, onValue } from \"firebase/database\";\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_apiKey,\n  authDomain: process.env.REACT_APP_authDomain,\n  projectId: process.env.REACT_APP_projectId,\n  storageBucket: process.env.REACT_APP_storageBucket,\n  messagingSenderId: process.env.REACT_APP_messagingSenderId,\n  appId: process.env.REACT_APP_appId,\n  databaseURL: process.env.REACT_APP_databaseURL\n};\nconst app = initializeApp(firebaseConfig);\n\nclass Database {\n  constructor() {\n    this.database = getDatabase(app);\n  }\n\n  getRef(fullPath) {\n    return ref(this.database, fullPath);\n  }\n\n  async setItem(path, id, item) {\n    await set(this.getRef(`${path}/${id}`), item);\n  }\n\n  async readItem(path, id) {\n    return new Promise((resolve, _) => {\n      const reference = this.getRef(`${path}/${id}`);\n      onValue(reference, item => {\n        return resolve(item.val());\n      });\n    });\n  }\n\n  async searchItems(path, query) {\n    const queriesList = Object.entries(query);\n    return new Promise((resolve, reject) => {\n      const reference = this.getRef(`${path}/`);\n      onValue(reference, allItemsInPath => {\n        if (!allItemsInPath.val()) {\n          console.log(1);\n          return reject();\n        }\n\n        const filteredItems = Object.entries(allItemsInPath.val()).filter(_ref => {\n          let [_, item] = _ref;\n          return queriesList.map(_ref2 => {\n            let [key, value] = _ref2;\n            return typeof item == 'object' && key in item && item[key] === value;\n          }).reduce((acc, cur) => acc && cur, true);\n        });\n        return resolve(filteredItems);\n      });\n    });\n  }\n\n}\n\nconst database = new Database();\nexport default database;","map":{"version":3,"sources":["D:/Bureau/Test React/coman-app/src/utils/database.js"],"names":["initializeApp","getDatabase","set","ref","onValue","firebaseConfig","apiKey","process","env","REACT_APP_apiKey","authDomain","REACT_APP_authDomain","projectId","REACT_APP_projectId","storageBucket","REACT_APP_storageBucket","messagingSenderId","REACT_APP_messagingSenderId","appId","REACT_APP_appId","databaseURL","REACT_APP_databaseURL","app","Database","constructor","database","getRef","fullPath","setItem","path","id","item","readItem","Promise","resolve","_","reference","val","searchItems","query","queriesList","Object","entries","reject","allItemsInPath","console","log","filteredItems","filter","map","key","value","reduce","acc","cur"],"mappings":"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","sourcesContent":["import { initializeApp } from \"firebase/app\";\r\nimport { getDatabase, set, ref, onValue } from \"firebase/database\"\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_apiKey,\r\n  authDomain: process.env.REACT_APP_authDomain,\r\n  projectId: process.env.REACT_APP_projectId,\r\n  storageBucket: process.env.REACT_APP_storageBucket,\r\n  messagingSenderId: process.env.REACT_APP_messagingSenderId,\r\n  appId: process.env.REACT_APP_appId,\r\n  databaseURL: process.env.REACT_APP_databaseURL\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\n\r\nclass Database {\r\n\r\n    constructor() {\r\n        this.database = getDatabase(app);\r\n    }\r\n\r\n    getRef(fullPath) {\r\n        return ref(this.database, fullPath)\r\n    }\r\n\r\n    async setItem(path, id, item) {\r\n        await set(this.getRef(`${path}/${id}`), item)\r\n    }\r\n\r\n    async readItem(path, id) {\r\n        return new Promise((resolve, _) => {\r\n            const reference = this.getRef(`${path}/${id}`);\r\n            onValue(reference, (item) => {\r\n                return resolve(item.val());\r\n            })\r\n        })\r\n    }\r\n\r\n    async searchItems(path, query) {\r\n        const queriesList = Object.entries(query);\r\n        return new Promise((resolve, reject) => {\r\n            const reference = this.getRef(`${path}/`);\r\n            onValue(reference, (allItemsInPath) => {\r\n                if (!allItemsInPath.val()) {\r\n                    console.log(1)\r\n                    return reject();\r\n                }\r\n                const filteredItems = Object.entries(allItemsInPath.val()).filter(\r\n                    ([ _, item ]) => {\r\n                        return queriesList.map( ([ key, value ]) => {\r\n                            return typeof(item) == 'object' && key in item && item[key] === value\r\n                        }).reduce((acc, cur) => acc && cur, true)\r\n                    }\r\n                )\r\n                return resolve(filteredItems)\r\n            })\r\n        })\r\n    }\r\n}\r\n\r\nconst database = new Database();\r\n\r\nexport default database;"]},"metadata":{},"sourceType":"module"}